{% extends "teacher/teacher_base.html" %}

{% block title %}Create User Account{% endblock %}

{% block content %}

<style>
.page-container {
  max-width: 600px;
  margin: 0 auto;
}

.page-header {
  text-align: center;
  margin-bottom: 32px;
}

.page-header h1 {
  margin: 0 0 8px 0;
  font-size: 28px;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 12px;
}

.page-header p {
  margin: 0;
  color: #6b7280;
}

.form-card {
  background: white;
  border-radius: 16px;
  padding: 32px;
  box-shadow: 0 4px 16px rgba(0,0,0,.08);
}

.note-box {
  background: #fef3c7;
  border: 2px solid #fbbf24;
  border-radius: 12px;
  padding: 16px;
  margin-bottom: 24px;
  display: flex;
  gap: 12px;
}

.note-box .icon {
  font-size: 20px;
}

.note-box .content {
  flex: 1;
}

.note-box .title {
  font-weight: 600;
  margin-bottom: 4px;
  color: #92400e;
}

.note-box .text {
  font-size: 14px;
  color: #78350f;
  margin: 0;
}

.form-section {
  margin-bottom: 24px;
}

.form-section h3 {
  margin: 0 0 16px 0;
  font-size: 16px;
  font-weight: 600;
  color: #374151;
}

.form-group {
  margin-bottom: 20px;
}

.form-group label {
  display: block;
  font-weight: 600;
  margin-bottom: 8px;
  color: #374151;
  font-size: 14px;
}

.form-group input,
.form-group select {
  width: 100%;
  padding: 12px;
  border: 2px solid #e5e7eb;
  border-radius: 8px;
  font-size: 14px;
  transition: border-color .2s;
}

.form-group input:focus,
.form-group select:focus {
  outline: none;
  border-color: #2563eb;
}

.role-selector {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 12px;
}

.role-option {
  border: 2px solid #e5e7eb;
  border-radius: 12px;
  padding: 16px;
  cursor: pointer;
  transition: all .2s;
  text-align: center;
}

.role-option input[type="radio"] {
  display: none;
}

.role-option .icon {
  font-size: 32px;
  margin-bottom: 8px;
}

.role-option .label {
  font-weight: 600;
  color: #374151;
}

.role-option:hover {
  border-color: #2563eb;
  background: #f0f9ff;
}

.role-option input[type="radio"]:checked + label {
  border-color: #2563eb;
  background: #dbeafe;
}

.role-option.selected {
  border-color: #2563eb;
  background: #dbeafe;
}

.role-option.disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.form-actions {
  display: flex;
  gap: 12px;
  margin-top: 32px;
}

.btn {
  padding: 12px 24px;
  border-radius: 8px;
  border: none;
  cursor: pointer;
  font-size: 14px;
  font-weight: 500;
  transition: all .2s;
  flex: 1;
}

.btn.primary {
  background: #2563eb;
  color: white;
}

.btn.primary:hover {
  background: #1d4ed8;
}

.btn.secondary {
  background: #f3f4f6;
  color: #374151;
}

.btn.secondary:hover {
  background: #e5e7eb;
}

.required {
  color: #ef4444;
}
</style>

<div class="page-container">
  <div class="page-header">
    <h1>
      <span>üë§</span>
      Create User Account
    </h1>
    <p>Create a new user account for the system</p>
  </div>

  <div class="form-card">
    {% if not is_school_admin %}
    <div class="note-box">
      <div class="icon">‚ö†Ô∏è</div>
      <div class="content">
        <div class="title">Note:</div>
        <p class="text">As a teacher, you can only create student accounts. Contact a school admin to create teacher accounts.</p>
      </div>
    </div>
    {% endif %}

    <form method="post">
      {% csrf_token %}

      <!-- Account Type -->
      <div class="form-section">
        <h3>Account Type <span class="required">*</span></h3>
        <div class="role-selector">
          <div class="role-option {% if not is_school_admin %}disabled{% endif %} selected" id="studentOption" onclick="selectRole('student', {{ is_school_admin|yesno:'true,false' }})">
            <div class="icon">üéì</div>
            <div class="label">Student</div>
            <input type="radio" name="role" value="student" id="roleStudent" checked required>
          </div>
          
          <div class="role-option {% if not is_school_admin %}disabled{% endif %}" id="teacherOption" onclick="selectRole('teacher', {{ is_school_admin|yesno:'true,false' }})">
            <div class="icon">üë®‚Äçüè´</div>
            <div class="label">Teacher</div>
            <input type="radio" name="role" value="teacher" id="roleTeacher" {% if not is_school_admin %}disabled{% endif %}>
          </div>
        </div>
      </div>

      <!-- Login Credentials -->
      <div class="form-section">
        <h3>Login Credentials</h3>
        
        <div class="form-group">
          <label for="username">Username <span class="required">*</span></label>
          <input
            type="text"
            name="username"
            id="username"
            placeholder="Enter username"
            required
          >
        </div>
        
        <div class="form-group">
          <label for="password">Password <span class="required">*</span></label>
          <input
            type="text"
            name="password"
            id="password"
            placeholder="Enter password"
            required
          >
        </div>
      </div>

      <!-- Personal Information -->
      <div class="form-section">
        <h3>Personal Information</h3>
        
        <div class="form-group">
          <label for="first_name">First Name</label>
          <input
            type="text"
            name="first_name"
            id="first_name"
            placeholder="Enter first name"
          >
        </div>
        
        <div class="form-group">
          <label for="last_name">Last Name</label>
          <input
            type="text"
            name="last_name"
            id="last_name"
            placeholder="Enter last name"
          >
        </div>
        
        <div class="form-group">
          <label for="email">Email</label>
          <input
            type="email"
            name="email"
            id="email"
            placeholder="Enter email address"
          >
        </div>
      </div>

      <!-- Actions -->
      <div class="form-actions">
        <a href="{% url 'school_users_list' %}" class="btn secondary">
          Cancel
        </a>
        <button type="submit" class="btn primary">
          ‚úì Create Account
        </button>
      </div>
    </form>
  </div>
</div>

<script>
function selectRole(role, isAdmin) {
  if (!isAdmin && role === 'teacher') {
    return; // Prevent selection
  }
  
  // Update visual selection
  document.getElementById('studentOption').classList.remove('selected');
  document.getElementById('teacherOption').classList.remove('selected');
  
  if (role === 'student') {
    document.getElementById('studentOption').classList.add('selected');
    document.getElementById('roleStudent').checked = true;
  } else {
    document.getElementById('teacherOption').classList.add('selected');
    document.getElementById('roleTeacher').checked = true;
  }
}
</script>

{% endblock %}