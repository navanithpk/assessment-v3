{% extends "teacher/teacher_base.html" %}

{% block title %}Class Performance{% endblock %}

{% block content %}
<style>
.filters {
  background: white;
  padding: 18px;
  border-radius: 14px;
  margin-bottom: 20px;
  box-shadow: 0 6px 20px rgba(0,0,0,.08);
}

.filter-grid {
  display: grid;
  grid-template-columns: 1fr 1fr auto;
  gap: 16px;
}

.filters select {
  padding: 10px;
  border-radius: 8px;
  border: 1px solid #ccc;
}

.table-wrap {
  background: white;
  padding: 18px;
  border-radius: 14px;
  box-shadow: 0 6px 20px rgba(0,0,0,.08);
}

table {
  width: 100%;
  border-collapse: collapse;
}

th, td {
  padding: 10px;
  font-size: 14px;
  border-bottom: 1px solid #e0e0e0;
}

th {
  background: #f3f4f6;
  text-align: left;
}
</style>

<h1>Class Performance</h1>

<form method="get" class="filters">
  <div class="filter-grid">
    <select name="test" required>
      <option value="">Select Test</option>
      {% for t in tests %}
        <option value="{{ t.id }}" {% if request.GET.test == t.id|stringformat:"s" %}selected{% endif %}>
          {{ t.title }}
        </option>
      {% endfor %}
    </select>

    <select name="group" required>
      <option value="">Select Class / Group</option>
      {% for g in groups %}
        <option value="{{ g.id }}" {% if request.GET.group == g.id|stringformat:"s" %}selected{% endif %}>
          {{ g.name }}
        </option>
      {% endfor %}
    </select>

    <button type="submit">View</button>
  </div>
</form>

{% if results %}
<div class="table-wrap">
  <table>
    <thead>
      <tr>
        <th>Student</th>
        <th>Grade</th>
        <th>Section</th>
        <th>Total Score</th>
      </tr>
    </thead>
    <tbody>
      {% for r in results %}
      <tr>
        <td>
          <a href="{% url 'student_performance' r.student.id %}">
            {{ r.student.full_name }}
          </a>
        </td>
        <td>{{ r.student.grade.name }}</td>
        <td>{{ r.student.section }}</td>
        <td>{{ r.score }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endif %}
{% endblock %}
